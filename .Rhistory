text(x = 1, y = kclusters$centers[, 1], labels = paste("Cluster", c(1:3)))
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 0.4)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("Cluster", c(1:3)))
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(0:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 0.4)
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 0.4)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("Cluster", c(1:3)))
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 0.4)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i+2, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("Cluster", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("Cluster", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(4,1,2,3,5,6,7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
for(i in c(1:3))
lines(kclusters$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
#for(i in c(1:3))
lines(kclusters$centers[1,], lty = 1, lwd = 2, col = "red")
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
#for(i in c(1:3))
lines(kclusters$centers[1,], lty = 1, lwd = 2, col = "red")
lines(kclusters$centers[2,], lty = 2, lwd = 2, col = "blue")
lines(kclusters$centers[3,], lty = 3, lwd = 2)
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
#for(i in c(1:3))
lines(kclusters$centers[1,], lty = 1, lwd = 2, col = "red")
lines(kclusters$centers[2,], lty = 2, lwd = 2, col = "green")
lines(kclusters$centers[3,], lty = 3, lwd = 2, col = "blue")
legend(x = "topleft", box.col = "brown",
bg ="yellow", box.lwd = 2 , title="Clusters",
legend=c("Cluster 1", "Cluster 2", "Cluster 3"),
fill = c("red","green", "blue"))
text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
library(dplyr)
library(ggplot2)
library(caret)
library(corrplot)
library(factoextra)
#Laptop Data import
#fuelDF = read.csv("C:\\EIA923.csv")
#Desktop Data Import
fuelDF = read.csv("F:\\EIA923.csv")
set.seed(7165)
str(fuelDF)
fuelDF_CH = fuelDF %>% select(-plant_id_eia, -plant_id_eia_label)
summary(fuelDF_CH)
#gasDF = fuelDF %>% filter(fuel_type_code_pudl == 'gas')
#oilDF = fuelDF %>% filter(fuel_type_code_pudl == 'oil')
#coalDF = fuelDF %>% filter(fuel_type_code_pudl == 'coal')
#boxplot(gasDF$fuel_received_units)
#summary(gasDF)
#summary(oilDF)
#summary(coalDF)
colMeans(is.na(fuelDF_CH))
#logDF = fuelDF %>% select(fuel_received_units) %>% mutate(logtrans = log(fuel_received_units + 1)) %>% scale()
fuelDF_CH$fuel_type_code_pudl = as.factor(fuelDF_CH$fuel_type_code_pudl)
dummy_fuel = dummyVars(~fuel_type_code_pudl, data = fuelDF_CH)
dummy_matrix = predict(dummy_fuel, fuelDF_CH)
fuelDF_CH.dummy = cbind(dummy_matrix, fuelDF_CH)
fuelDF.clean = fuelDF_CH.dummy %>% select(-fuel_type_code_pudl) %>% scale()
#fuelDF.clean = cbind(fuelDF.clean, logDF)
cor_matrix = data.frame(cor(fuelDF.clean))
cor_matrix
fuelDF.clean = as.data.frame(fuelDF.clean)
fuelDF.clean = fuelDF.clean %>% select(-fuel_received_units)
fviz_nbclust(fuelDF.clean, kmeans, method = "wss")
fviz_nbclust(fuelDF.clean, kmeans, method = "silhouette")
kclusters = kmeans(fuelDF.clean, centers = 3)
fviz_cluster(kclusters, data = fuelDF.clean)
#Centers
kclusters$centers
#Setting up and plotting centroids
mincenter = min(kclusters$centers)
maxcenter = max(kclusters$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 7))
axis(1, at = c(1:7), xpd = TRUE, labels = c("Coal","Gas","Oil","MMBTU", "Sulfur", "Ash", "Cost"), cex.axis = 1)
#for(i in c(1:3))
lines(kclusters$centers[1,], lty = 1, lwd = 2, col = "red")
lines(kclusters$centers[2,], lty = 2, lwd = 2, col = "green")
lines(kclusters$centers[3,], lty = 3, lwd = 2, col = "blue")
legend(x = "topleft", box.col = "brown",
bg ="yellow", box.lwd = 2 , title="Clusters",
legend=c("Cluster 1", "Cluster 2", "Cluster 3"),
fill = c("red","green", "blue"))
#text(x = 0.5, y = kclusters$centers[, 1], labels = paste("C", c(1:3)))
View(kclusters)

library(fpc)
library(ggplot2)
set.seed(123)
#laptop Data Import
#wines = read.csv("C:\\wine-clustering.csv")
#Desktop Data Import
wines = read.csv("F:\\wine-clustering.csv")
#Check the structure of the data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Normalize data
wines.norm = scale(wines)
#finding a optimal value for k using Elbow Method
fviz_nbclust(wines.norm, kmeans, method = "wss")
#finding optimal value for k using Silhouette
fviz_nbclust(wines.norm, kmeans, method = "silhouette")
#Performing K means with a k value of 3 based on the elbow point and the peak Silhouette
k3 = kmeans(wines.norm, centers = 3, nstart = 25)
#Plot of clusters
fviz_cluster(k3, data = wines.norm)
#Centers
k3$centers
#Setting up and plotting centroids
mincenter = min(k3$centers)
maxcenter = max(k3$centers)
plot(c(0), xaxt = 'n', ylab = "", type ="l", ylim = c(mincenter, maxcenter), xlim = c(0, 13))
axis(1, at = c(1:13), xpd = TRUE, labels = c("Alc","Malic","Ash","Alca_Ash","Mag","T_Phenols","Flavanoids","NonFlav", "Proanth", "Color", "Hue", "OD280", "Proline"), cex.axis = 0.4)
for(i in c(1:3))
lines(k3$centers[i,], lty = i, lwd = 2)
text(x = 0.5, y = k3$centers[, 1], labels = paste("Cluster", c(1:3)))
#size
k3$size
#withinss
k3$withinss
#determining eps
dbscan::kNNdistplot(wines.norm, k = 3)
abline(h = 2.8, lty = 2)
dbs.wine = fpc::dbscan(wines.norm, eps = 2.8, MinPts = 3)
print(dbs.wine)
fviz_cluster(dbs.wine, wines.norm, stand = FALSE, frame = FALSE, geom = "point")
#determining eps
dbscan::kNNdistplot(wines.norm, k = 26)
abline(h = 3.7, lty = 2)
dbs.wine = fpc::dbscan(wines.norm, eps = 3.7, MinPts = 26)
print(dbs.wine)
fviz_cluster(dbs.wine, wines.norm, stand = FALSE, frame = FALSE, geom = "point")
#determining eps
dbscan::kNNdistplot(wines.norm, k = 3)
abline(h = 2.3, lty = 2)
dbs.wine = fpc::dbscan(wines.norm, eps = 2.3, MinPts = 3)
print(dbs.wine)
fviz_cluster(dbs.wine, wines.norm, stand = FALSE, frame = FALSE, geom = "point")
install.packages("clusters")
install.packages("cluster")
install.packages("cluster")
library(ggplot2)
library(cluster)
library(dplyr)
library(ggplot2)
library(cluster)
library(dplyr)
wines = read.csv("C:\\Wine-clustering.csv")
View(wines)
library(ggplot2)
library(cluster)
library(dplyr)
wines = read.csv("C:\\Wine-clustering-HC.csv")
View(wines)
#Prepairing Data
str(wines)
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
View(wines_n)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
View(wines_n.norm)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agens(wines_n.norm, method = "ward")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
pltree(agnes_single, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
#pltree(agnes_single, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -1, main = "Dendogram of Diana")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 1, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.1, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.2, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.3, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.5, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.7, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
pltree(diana.hc, cex = 0.6, hang = -1, main = "Dendogram of Diana")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -5, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = 5, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
pltree(diana.hc, cex = 0.6, hang = 0, main = "Dendogram of Diana")
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -2, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
#checking structure of data
str(wines)
#summary check
summary(wines)
#Check for missing values
colMeans(is.na(wines))
#Removing categorical variables
wines_n = wines %>% select(-Alcohol_Level, -Ash_Content, -Color_Intensity_Group)
#Normalize data
wines_n.norm = scale(wines_n)
agnes_single = agnes(wines_n.norm, method = "single")
agnes_complete = agnes(wines_n.norm, method = "complete")
agnes_average = agnes(wines_n.norm, method = "average")
agnes_ward = agnes(wines_n.norm, method = "ward")
print(agnes_single$ac)
print(agnes_complete$ac)
print(agnes_average$ac)
print(agnes_ward$ac)
pltree(agnes_ward, cex = 0.6, hang = -1, main = "Dendrogram of Agnes")
rect.hclust(agnes_ward, k = 3, border = 1:3)
diana.hc = diana(wines_n.norm)
print(diana.hc$dc)
pltree(diana.hc, cex = 0.6, hang = -1, main = "Dendogram of Diana")
rect.hclust(diana.hc, k = 3, border = 1:3)
View(agnes_complete)
print(paste("The highest AC comes from using Ward and is:"), agnes_ward$ac)
print(paste("The highest AC comes from using Ward and is:"), 2)
print(paste("The highest AC comes from using Ward and is:"))
war = agnes_ward$ac
print(paste("The highest AC comes from using Ward and is:", agnes_ward$ac)
war = agnes_ward$ac
print(paste("The highest AC comes from using Ward and is:", agnes_ward$ac))
print(paste("The highest AC comes from using Ward and is:", agnes_ward$ac))
print(paste("The DC is:", diana.hc$dc))
